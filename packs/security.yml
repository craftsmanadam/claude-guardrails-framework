name: security
kind: pack
sections:
  Security:
    - Never introduce hard-coded secrets or tokens.
    - Prefer least-privilege access patterns.
    - Flag risky changes and request confirmation.
    - "Secrets management":
        - store secrets, credentials, and sensitive config in environment variables.
        - Never commit actual secrets to version control.
        - "For local development, use .env.secrets files for secrets and ensure they are in .gitignore."
        - "Provide a .env.secrets.example with placeholder values to document required configuration."
        - "Example placeholders: DATABASE_PASSWORD=change-me, API_KEY=your-key-here."
        - "Test doubles and mock services may use hardcoded values if clearly marked (e.g., mock_oauth2_server with test_secret)."
        - "Load secrets using os.environ.get() or pydantic-settings."
    - text: "Trivy scan required for built image."
      when:
        profiles: [strict, moderate]
        targets: [microservice]
